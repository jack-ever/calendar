<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>تقویم شمسی</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #f9f9f9;
      padding: 20px;
    }
    h1 {
      font-size: 28px;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      width: 14.28%;
    }
    th {
      background-color: #eee;
    }
    .event {
      background-color: #ffe0e0;
      color: #b00;
      font-weight: bold;
    }
    button {
      margin: 10px;
      padding: 8px 16px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1 id="date"></h1>
  <h1 id="month-title">تقویم ماهیانه</h1>

  <div>
    <button onclick="prevMonth()">ماه قبل</button>
    <button onclick="nextMonth()">ماه بعد</button>
  </div>

  <table id="calendar-table">
    <!-- جدول روزها اینجا ساخته می‌شه -->
  </table>

  <script>
    const weekdays = ['شنبه', 'یک‌شنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنج‌شنبه', 'جمعه'];
    const persianMonths = ['فروردین','اردیبهشت','خرداد','تیر','مرداد','شهریور','مهر','آبان','آذر','دی','بهمن','اسفند'];

    const events = {
      '1402-06-01': 'آغاز سال تحصیلی',
      '1402-06-05': 'روز کارگر',
      '1402-06-31': 'پایان شهریور'
    };

    let currentDate = new Date();

    function toJalaliDate(date) {
      const options = { year: 'numeric', month: 'numeric', day: 'numeric', calendar: 'persian' };
      const parts = date.toLocaleDateString('fa-IR', options).split('/');
      return {
        year: parseInt(parts[0]),
        month: parseInt(parts[1]),
        day: parseInt(parts[2])
      };
    }

    function showToday() {
      const options = { year: 'numeric', month: 'long', day: 'numeric', calendar: 'persian' };
      document.getElementById("date").innerText = currentDate.toLocaleDateString('fa-IR', options);
    }

    function buildCalendar(year, month) {
      const table = document.getElementById("calendar-table");
      table.innerHTML = '';

      const headerRow = document.createElement('tr');
      weekdays.forEach(day => {
        const th = document.createElement('th');
        th.innerText = day;
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);

      const firstDay = new Date(currentDate);
      firstDay.setDate(1);
      const jalaliFirst = toJalaliDate(firstDay);
      jalaliFirst.year = year;
      jalaliFirst.month = month;
      jalaliFirst.day = 1;

      const tempDate = new Date();
      tempDate.setFullYear(year);
      tempDate.setMonth(month - 1);
      tempDate.setDate(1);
      const startDay = tempDate.getDay();

      const daysInMonth = [31,31,31,31,31,31,30,30,30,30,30,29];
      const isLeap = ((year - 474) % 2820 + 474 + 38) * 682 % 2816 < 682;
      if (month === 12 && isLeap) daysInMonth[11] = 30;

      let row = document.createElement('tr');
      for (let i = 0; i < startDay; i++) {
        row.appendChild(document.createElement('td'));
      }

      for (let day = 1; day <= daysInMonth[month - 1]; day++) {
        const cell = document.createElement('td');
        const key = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
        cell.innerText = day;
        if (events[key]) {
          cell.classList.add('event');
          cell.title = events[key];
        }
        row.appendChild(cell);
        if ((startDay + day) % 7 === 0) {
          table.appendChild(row);
          row = document.createElement('tr');
        }
      }
      table.appendChild(row);

      document.getElementById("month-title").innerText = `${persianMonths[month - 1]} ${year}`;
    }

    function prevMonth() {
      const jalali = toJalaliDate(currentDate);
      jalali.month--;
      if (jalali.month < 1) {
        jalali.month = 12;
        jalali.year--;
      }
      currentDate.setMonth(currentDate.getMonth() - 1);
      buildCalendar(jalali.year, jalali.month);
    }

    function nextMonth() {
      const jalali = toJalaliDate(currentDate);
      jalali.month++;
      if (jalali.month > 12) {
        jalali.month = 1;
        jalali.year++;
      }
      currentDate.setMonth(currentDate.getMonth() + 1);
      buildCalendar(jalali.year, jalali.month);
    }

    showToday();
    const jalaliNow = toJalaliDate(currentDate);
    buildCalendar(jalaliNow.year, jalaliNow.month);
  </script>
</body>
</html>
